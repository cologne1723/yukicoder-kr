# No. 1855 Intersected Lines

## 제한

- 시간 제한: 2초
- 메모리 제한: 512MB

## 문제

원주상에 $2N$개의 점이 등간격으로 있고, 시계방향으로 $1, 2, \cdots, 2N$이라고 번호가 붙어있습니다.

단, 문자열 $S$의 $i$번째 문자가 `R`인 경우에 점 $i$는 빨간색으로, `B`는 파란색으로 칠해져 있습니다.

여기서, 원주상의 $2N$개의 점을 $N$개의 쌍으로 다음의 조건을 만족하며 연결하는 방법을 **좋은 분할법**이라 정의합니다.

- $N$개의 쌍 모두에 대해, 쌍에 포함된 두 점이 같은 색이다.
- $2N$개의 점 모두에 대해, 그 점은 정확히 $1$개의 쌍에 포함되어 있다.

또한, 좋은 분할법의 **점수**를 다음과 같이 정의합니다.

- 모든 쌍에 대해, 쌍에 포함된 두 점을 이은 선분을 그립니다. 이 이후에, $N$개의 선분에서 $2$개의 선분을 골랐을 때, $2$개의 선분이 교차하는 경우의 수

좋은 분할법의 점수의 기대값을 구해주세요. 주어지는 입력은, 좋은 분할법이 항상 존재한다는것이 보장됩니다.

여기서, 답은 서로소인 $0$ 이상의 정수 $P, Q$에 대해 $\frac{P}{Q}$로 표현 가능하고, $R \times Q \equiv P \pmod {998244353}$과 $0 \le R < 998244353$을 만족하는 정수 $R$이 하나로 정해지는 것을 증명할 수 있으므로, $R$을 출력해주세요.

단, 이 문제에 대해 $S$를 다음과 같이 정의합니다.

- 문자열 $X$와 문자 $C_1, C_2, \cdots, C_X$와 수 $V_1, V_2, \cdots, V_X$가 주어집니다. $S_i$는 $C_i$를 $V_i$문자 반복한 것이고, $S$는 $S_1, S_2, \cdots, S_X$를 순서대로 나열한 것입니다.

## 입력

| $N$ $X$<br>$C_1$ $V_1$<br>$C_2$ $V_2$<br>$\vdots$<br>$C_X$ $V_X$ |
| :------------------------------------------------------------ |

- $1 \le N \le 499122176 = \frac{998244353-1}{2}$
- $1 \le X \le 4 \times 10^5$
- $C_i$는 `R` 혹은 `B` ($1 \le i \le X$)
- $1 \le V_i \le 2N$ ($1 \le i \le X$)
- $V_1 + V_2 + \cdots + V_X = 2N$
- $N$, $X$, $V_i$는 정수.
- 좋은 분할법이 존재한다.

## 출력

문제에 적힌 $R$을 출력한 후, 개행문자를 출력해주세요.

## 예제

### 예제 1

입력

```
2 4
R 1
B 1
R 1
B 1
```

출력

```
1
```

![img](https://media.discordapp.net/attachments/838599057781293066/838618072704876584/image0.jpg?width=319&height=319)

$S$는 `RBRB`입니다. 좋은 분할법은 $\{1, 3\}, \{2, 4\}$ 한 종류가 있습니다.

이 좋은 분할법의 점수는 그림과 같이 $1$이므로, 답은 $1$입니다. (가장 위의 점이 $1$번 점입니다.)

### 예제 2

입력

```
4 5
B 4
R 1
B 1
B 1
R 1
```

출력

```
798595485
```

![img](https://media.discordapp.net/attachments/838599057781293066/838617485762232362/image0.jpg?width=319&height=319)

$S$는 `BBBBRBBR`입니다. 예를 들어, $\{1, 6\}, \{2, 4\}, \{3, 7\}, \{5, 8\}$과 같은 좋은 분할법의 점수는 위 그림과 같이 $4$입니다. 답은 $\frac{13}{5}$입니다.

### 예제 3

입력

```
24 19
B 3
R 1
B 2
R 1
B 1
R 3
B 2
R 1
B 4
R 1
B 1
R 2
B 1
R 7
B 7
R 2
B 6
R 2
B 1
```

출력

```
865923553
```

$S$는 `BBBRBBRBRRRBBRBBBBRBRRBRRRRRRRBBBBBBBRRBBBBBBRRB`입니다.
