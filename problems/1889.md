# No.1887 K Consecutive Ks (Hard)

## 제한

- 시간 제한: 6초
- 메모리 제한: 512MB

## 문제

**[문제 E](https://yukicoder.me/problems/7842)**와 제한과 시간 제한을 제외하고 같은 문제입니다.

$1$ 이상 $M$ 이하의 정수로 이루어진 길이 $N$의 수열 $A = (A_1, A_2, \cdots, A_N)$에 대해, 다음의 조건을 만족하는 것의 개수를 구해주세요.

- $A$에는, 어떤 정수 $k$가 $k$개 연속 등장하는 위치가 있다. 즉, 어떤 정수 $i, k$ $(i+k-1 \le N)$이 존재해서, $A_i = A_{i+1} = \cdots = A_{i+k-1} = k$를 만족한다.

답이 매우 클 수 있으니, $998244353$으로 나눈 나머지를 출력해주세요.

## 입력

|$N$ $M$|
|:-|

- 모든 입력은 정수다.

- $1 \le N \le 2 \times 10^5$
- $1 \le M \le 2 \times 10^5$

## 출력

조건을 만족하는 $A$의 개수를 $998244353$으로 나눈 나머지를 출력해주세요. 마지막에 개행문자를 출력해주세요.

## 예제

### 예제 1

입력

```
2 3
```

출력

```
6
```

조건을 만족하는 $A$는 다음 $6$개 입니다.

- $(1, 1), (1, 2), (1, 3), (2, 1), (3, 1)$에는 $1$이 $1$개 연속해서 등장하는 위치가 있습니다.
- $(2, 2)$에는 $2$가 $2$개 연속해서 등장하는 위치가 있습니다.


### 예제 2

입력

```
5 4
```

출력

```
884
```

조건을 만족하는 $A$의 예입니다.

- $(4, 2, 4, 1, 3)$에는 $1$이 $1$개 연속해서 등장하는 위치가 있습니다.
- $(4, 3, 3, 3, 2)$에는 $3$이 $3$개 연속해서 등장하는 위치가 있습니다.
- $(2, 2, 4, 2, 2)$에는 $2$이 $2$개 연속해서 등장하는 위치가 있습니다.
- $(2, 2, 3, 3, 3)$에는 $2$이 $2$개 연속해서 등장하는 위치, $3$이 $3$개 연속해서 등장하는 위치가 있습니다.
- $(3, 3, 3, 3, 3)$에는 $3$이 $3$개 연속해서 등장하는 위치가 있습니다.
### 예제 3

입력

```
200000 200000
```

출력

```
602367127
```

$998244353$으로 나눈 나머지를 출력해주세요.