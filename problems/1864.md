# No. 1864 Shortest Paths Counting

## 제한

- 시간 제한: 2초
- 메모리 제한: 512MB

## 문제

2차원 평면상에 서로 다른 $N$개의 점이 있어서, $1$번부터 $N$번까지의 번호가 붙어있습니다. $i$번 점의 좌표는 $(X_i, Y_i)$입니다.

$(x_0, y_0)$와 $(x_1, y_1)$의 거리를 $\max(\lvert x_0-x_1 \rvert, \lvert y_0 - y_1 \rvert)$로 정의됩니다.

이 때, 몇 개의 점을 경유해서 $1$번 점부터 $N$번 점까지 이동할 때, 이동 거리의 합이 최소가 되는 경우의 수를 구해주세요. 

엄밀하게는, $p_1 = 1$, $p_k = N$, $1 \le p_i \le N$ ($1 \le i \le k$) 그리고 $p_i \ne p_{i+1}$ ($1 \le i \le k-1$)를 만족하는 길이 $k$의 수열 $p$가 존재해서 $\sum_{i=1}^{k-1} \max(\lvert X_{p_{i+1}}-X_{p_i} \rvert, \lvert Y_{p_{i+1}} - Y_{p_i} \rvert)$가 최소가 되는 수열의 개수를 구해주세요.

단, 답이 매우 클 수 있으니, $998244353$으로 나눈 나머지를 구해주세요.

## 입력

| $N$<br>$X_1$ $Y_1$<br>$X_2$ $Y_2$<br>$\vdots$<br>$X_N$ $Y_N$ |
| ---- |

- $2 \le N \le 2 \times 10^5$
- $-10^9 \le X_i, Y_i \le 10^9$ ($1 \le i \le N$)
- $(X_i, Y_i) \ne (X_j, Y_j)$ ($i \ne j$)
- 입력은 모두 정수
## 출력

거리의 총합이 최소가 되는 이동방법을 $998244353$으로 나눈 나머지를 출력해주세요.

단, 마지막에 개행문자를 출력해주세요.

## 예제

### 예제 1

입력

```
3
0 0
0 1
1 2
```

출력

```
2
```

다음의 $2$개의 경로가 존재합니다.

- $1$번 점 $\rightarrow$ $3$번 점
- $1$번 점 $\rightarrow$ $2$번 점 $\rightarrow$ $3$번 점

예를 들어 두 번째 경로에서는, 거리의 합이 $\max(|0-0|,|0-1|)+\max(|0-1|,|2-1|) = 1+1 = 2$가 됩니다.

### 예제 2

입력

```
5
0 6
1 5
3 2
5 5
3 0
```

출력

```
-1
```

다음의 $4$개의 경로가 존재합니다.

- $1$번 점 $\rightarrow$ $5$번 점
- $1$번 점 $\rightarrow$ $2$번 점 $\rightarrow$ $5$번 점
- $1$번 점 $\rightarrow$ $3$번 점 $\rightarrow$ $5$번 점
- $1$번 점 $\rightarrow$ $2$번 점 $\rightarrow$ $3$번 점 $\rightarrow$ $5$번 점

### 예제 3

입력

```
10
-8 1
3 -5
-4 8
5 -4
-1 -6
6 0
-1 -4
2 -9
-6 7
10 -9
```

출력

```
14
```

### 예제 4

입력

```
14
0 0
7 -7
11 -3
9 -1
7 1
7 -5
10 -2
8 0
4 4
5 1
5 3
7 -3
6 2
12 -4
```

출력

```
334
```
